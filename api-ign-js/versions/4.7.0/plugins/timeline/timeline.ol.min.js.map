{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/templates/timeline.html","webpack:///./src/templates/timelineDinamic.html","webpack:///./src/impl/ol/js/timelinecontrol.js","webpack:///./src/facade/js/i18n/language.js","webpack:///./src/facade/js/timelinecontrol.js","webpack:///./src/facade/js/timeline.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","TimelineControl","_M$impl$Control","_inherits","M","impl","Control","_super","_createSuper","_classCallCheck","apply","arguments","map","html","this","olMap","getMapImpl","_get","_getPrototypeOf","translations","en","es","getLang","res","language","getTranslation","lang","timeline","getValue","keyPath","length","undefined","translation","utils","isNullOrEmpty","console","warn","concat","split","reduce","prev","current","_M$Control","options","_this","isUndefined","TimelineImplControl","exception","timelineType","running","animation","speed","includes","intervals","entries","_ref","_ref2","_slicedToArray","values","_this$transformTime_N2","transformTime_NumbToDate","init","end","paramsDate","speedDate","stepValue","formatValue","formatMove","sizeWidthDinamic","date","allLayersDinamic","groupLayer","noGroupLayer","template","_this2","Promise","success","fail","type","compileSync","templateDinamic","vars","title","play","initValue","endValue","createtimeLineDinamic","forEach","interval","k","layer","transformToLayers","copy","getMapLayer","removeLayers","addLayers","iv","number","tag","service","push","document","createElement","parseInt","dataset","querySelector","append","style","setProperty","slider","setAttribute","addEventListener","e","changeSlider","classList","add","remove","clearTimeout","playTimeline","newLayer","layerByObject","getLayers","filter","isValidLayer","indexOf","urlLayer","toUpperCase","WMS","url","WMTS","layerByName","displayInLayerSwitcher","setVisible","elem","_this3","left","min","max","display","step","parseFloat","innerHTML","layerSearch","getImpl","legend","next","_this4","setTimeout","_this5","clearInterval","control","createStepsTimeLine","createSelectorLayers","createInputDate","_this6","event","_ref3","target","_ref3$key","getValues_inputDate","changeDateLayer","Date","getTime","changeValueSlider","_ref4","_ref4$key","valueInit","_this7","selectDinamic","_ref5","id","grupo","attributeParam","_ref5$equalsTimeLine","equalsTimeLine","transformToLayersDinamic","layerGroup","find","_ref6","lastGroup","lastGroup_init","getAttribute","lastGroup_end","layers","selectorEventLayer","_this8","_ref7","contains","stepsTimeLineDinamic","_ref8","evtFormatMove","_ref9","_ref10","Vector","layerTimeLine","_layer$split2","layerWMS","params","CQL_FILTER","toISOString","format","formatRevert","getReverseFormat","dateToNumber","getFormatValue","_this9","_ref11","selectedIndex","changeValueInputDate","sliderEventDinamic","selected","children","removeAttribute","_ref12","changeVectorLayer","layerNoGroup","_ref13","_this10","generateValueSlider","_ref14","inputvalue","Number","valueEnd","_ref15","inputInit","inputEnd","dateInit","dateEnd","querySelectorAll","_this11","layersTimeLine","getLayerTimeLine","on","evt","LOAD","searhDinamic","searchLayerDinamic","_this11$getGroupLimit2","getGroupLimit","vectorInitValue","vectorEndValue","Function","f","dateTime","getAttributes","setFilter","_this11$getGroupLimit4","wmsInitValue","wmsEndValue","_this12","_this12$getGroupLimit2","_this13","_this$getValueDateInp2","getValueDateInput","numberIntEnd","sliderMax","getValueSliderB","getValueBeforeEvent","sliderMin","getValueBackEvent","_map2","reverseInit","reverseEnd","getStepValue","exponential","logarithmic","_this14","setInterval","userValues","isNaN","val","_this$formatValueType2","formatValueType","minv","scale","Math","round","exp","fristDate","endDate","maxv","log","abs","_this$formatValueType4","Timeline","_M$Plugin","Plugin","name_","map_","controls_","className","positions","position","isString","JSON","parse","replace","isArray","metadata_","api","metadata","tooltip_","tooltip","Error","control_","panel_","ui","Panel","collapsible","collapsedButtonClass","addControls","addPanels","removeTimelineLayers","removeControls","radius","stringify","activate","deactivate","plugin","window","M$plugin$Timeline","M$control$TimelineControl","M$impl$control$TimelineControl"],"mappings":"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","file":"timeline.ol.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","module.exports = \"<div id=\\\"div-contenedor\\\" class=\\\"m-timeline-container\\\">\\r\\n    <div id=\\\"m-timeline-title\\\">{{translations.title}}</div>\\r\\n    <div class=\\\"div-m-timeline-panel\\\">\\r\\n        <div class=\\\"div-m-timeline-slider\\\">\\r\\n            <input type=\\\"range\\\" min=\\\"0\\\" max=\\\"100\\\" value=\\\"0\\\" step=\\\"any\\\" id=\\\"input-slider\\\"></input>\\r\\n            <div class='slider-tags'></div>\\r\\n        </div>\\r\\n        <div class=\\\"m-timeline-names\\\">\\r\\n            \\r\\n        </div>\\r\\n        <div class=\\\"m-timeline-button\\\">\\r\\n            <button id=\\\"m-timeline-play\\\" class=\\\"timeline-control-siguiente\\\" title=\\\"Iniciar paso del tiempo\\\"></button>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\";","module.exports = \"<div id=\\\"div-contenedor\\\" class=\\\"m-timeline-container {{sizeWidthDinamic}}\\\">\\n    <div id=\\\"m-timeline-title\\\">{{translations.title}}</div>\\n    <div>\\n        <div>\\n            <div>  <!-- Movil class rotate -->\\n                <!-- Basic structure -->\\n                <div class='wrap' style='--a: -30; --b: 20; --min: -50; --max: 50'>\\n                    <input id='a' type='range' min='0' value='0' max='0'/>\\n                    <input id='b' type='range' min='0' value='0' max='0'/>\\n                </div>\\n            </div>\\n        \\n            <div class='slider-tags-dinamic'>\\n                <div>\\n                    <label for=\\\"init\\\">{{translations.initValue}}: </label>\\n                    <input id=\\\"init\\\" type=\\\"text\\\">\\n                </div>\\n                \\n                <div>\\n                    <label for=\\\"init\\\">{{translations.endValue}}: </label>\\n                    <input id=\\\"end\\\" type=\\\"text\\\">\\n                </div>\\n            </div>\\n        </div>\\n        <div class=\\\"m-timelineDinamic-button\\\">\\n\\n            <select class=\\\"selectDinamicLayer\\\" name=\\\"dinamicLayer\\\" id=\\\"selectDinamicLayer\\\">\\n                <option value=\\\"\\\"> Sin Capa </option>\\n            </select>\\n\\n            <button id=\\\"m-timelineDinamic-back\\\" class=\\\"timelineDinamic-control-play\\\" title=\\\"Iniciar paso del tiempo\\\"><<</button>\\n            <button id=\\\"m-timelineDinamic-play\\\" class=\\\"timelineDinamic-control-play\\\" title=\\\"Iniciar paso del tiempo\\\">Play/Pausa</button>\\n            <button id=\\\"m-timelineDinamic-before\\\" class=\\\"timelineDinamic-control-play\\\" title=\\\"Iniciar paso del tiempo\\\">>></button>\\n            <!-- ParametrizaciÃ³n del valor incremento de paso -->\\n        </div>\\n    </div>\\n</div>\";","/**\r\n * @module M/impl/control/TimelineControl\r\n */\r\n\r\nexport default class TimelineControl extends M.impl.Control {\r\n  /**\r\n   * This function adds the control to the specified map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the plugin\r\n   * @param {HTMLElement} html of the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map, html) {\r\n    this.map = map;\r\n    this.olMap = map.getMapImpl();\r\n\r\n    super.addTo(map, html);\r\n  }\r\n}\r\n","import en from './en';\nimport es from './es';\n\n/**\n * Default object with es and en translate.\n *\n * @const\n * @type {object}\n */\nconst translations = {\n  en,\n  es,\n};\n\nconst getLang = () => {\n  let res = 'es';\n  if (typeof M.language.getLang === 'function') {\n    res = M.language.getLang();\n  }\n\n  return res;\n};\n\n/**\n * This function sets a new language translate.\n * @param {string} lang\n * @param {JSON} json\n * @public\n * @api\n */\nexport const addTranslation = (lang, json) => {\n  translations[lang] = json;\n};\n\n/**\n * This function gets a language translate.\n *\n * @param {string} lang\n * @return {JSON}\n * @public\n * @api\n */\n export const getTranslation = (lang) => {\n  if (lang === 'es' || lang === 'en') {\n    return translations[lang];\n  }\n  return M.language.getTranslation(lang).timeline;\n};\n\n/**\n * This function gets a language value from key\n *\n * @public\n * @param {string}\n * @param {string}\n * @return {string}\n * @public\n * @api\n */\n\nexport const getValue = (keyPath, lang = getLang()) => {\n  const translation = getTranslation(lang);\n  let value = '';\n  if (M.utils.isNullOrEmpty(translation)) {\n    /* eslint-disable no-console */\n    console.warn(`The translation '${lang}' has not been defined.`);\n  } else {\n    value = keyPath.split('.').reduce((prev, current) => prev[current], translation);\n  }\n\n  return value;\n};\n","/**\r\n * @module M/control/TimelineControl\r\n */\r\n\r\nimport TimelineImplControl from 'impl/timelinecontrol';\r\nimport template from 'templates/timeline';\r\nimport templateDinamic from 'templates/timelineDinamic';\r\nimport { getValue } from './i18n/language';\r\n\r\nexport default class TimelineControl extends M.Control {\r\n  /**\r\n   * @classdesc\r\n   * Main constructor of the class. Creates a PluginControl\r\n   * control\r\n   *\r\n   * @constructor\r\n   * @extends {M.Control}\r\n   * @api stable\r\n   */\r\n  constructor(options) {\r\n    // 1. checks if the implementation can create PluginControl\r\n    if (M.utils.isUndefined(TimelineImplControl)) {\r\n      M.exception(getValue('exception'));\r\n    }\r\n    // 2. implementation of this control\r\n    const impl = new TimelineImplControl();\r\n    super(impl, 'Timeline');\r\n\r\n    this.timelineType = options.timelineType;\r\n\r\n    this.running = false;\r\n    this.animation = options.animation;\r\n    this.speed = options.speed;\r\n  \r\n    // Dinamic TimeLine\r\n    if(!['absolute', 'relative'].includes(this.timelineType)) {\r\n      this.intervals = options.intervals;\r\n    }else {\r\n      this.intervals = (options.intervals) ? Object.entries(options.intervals).map(([key, values]) => {\r\n        const [init, end] = this.transformTime_NumbToDate(values.init, values.end)\r\n        values.init = init;\r\n        values.end = end;\r\n        return values;\r\n      }) : undefined;\r\n    }\r\n   \r\n    this.paramsDate = options.paramsDate;\r\n    this.speedDate = options.speedDate;\r\n    this.stepValue = options.stepValue;\r\n    this.formatValue = options.formatValue\r\n    this.formatMove = options.formatMove;\r\n    this.sizeWidthDinamic = options.sizeWidthDinamic;\r\n\r\n    this.date = {\r\n      init: 0,\r\n      end: 0\r\n    }\r\n\r\n    this.allLayersDinamic = {\r\n      groupLayer: [],\r\n      noGroupLayer: []\r\n    };\r\n\r\n    /**\r\n     * Template\r\n     * @public\r\n     * @type { HTMLElement }\r\n     */\r\n    this.template = null;\r\n  }\r\n\r\n  /**\r\n   * This function creates the view\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the control\r\n   * @api stable\r\n   */\r\n  createView(map) {\r\n    this.map = map;\r\n    return new Promise((success, fail) => {\r\n      const type = ['absolute', 'relative'].includes(this.timelineType);\r\n      this.template = M.template.compileSync((type) ? templateDinamic : template, {\r\n        vars: {\r\n          translations: {\r\n            title: getValue('title'),\r\n            play: getValue('play'),\r\n            initValue: getValue('initValue'),\r\n            endValue: getValue('endValue')\r\n          },\r\n          sizeWidthDinamic: this.sizeWidthDinamic\r\n        }\r\n      });\r\n\r\n      if (type) {\r\n        this.createtimeLineDinamic();\r\n        success(this.template);\r\n      } else {\r\n        let intervals = [];\r\n        this.intervals.forEach((interval, k) => {\r\n          const layer = this.transformToLayers(interval[2]);\r\n          const copy = this.getMapLayer(layer);\r\n          if (copy !== undefined) {\r\n            this.map.removeLayers(copy);\r\n          }\r\n          this.map.addLayers(layer);\r\n          let iv = {\r\n            number: k,\r\n            name: interval[0],\r\n            tag: interval[1],\r\n            service: layer\r\n          }\r\n          intervals.push(iv);\r\n        });\r\n        this.intervals = intervals;\r\n\r\n        this.intervals.forEach((interval, k) => {\r\n          let tag = document.createElement('div');\r\n          if (k != 0 && k != this.intervals.length - 1 && k != parseInt(this.intervals.length / 2)) {\r\n            tag.dataset.tag = '';\r\n          } else {\r\n            tag.dataset.tag = interval.tag;\r\n          }\r\n          this.template.querySelector('.slider-tags').append(tag);\r\n        });\r\n        this.template.querySelector('.div-m-timeline-panel').style.setProperty('--num', this.intervals.length);\r\n        const slider = this.template.querySelector('#input-slider');\r\n        slider.setAttribute('max', intervals.length - 1);\r\n        slider.addEventListener('input', (e) => this.changeSlider(slider));\r\n        slider.addEventListener('change', (e) => {\r\n          document.querySelector('.m-timeline-button button').classList.add('timeline-control-siguiente');\r\n          document.querySelector('.m-timeline-button button').classList.remove('timeline-control-pausa');\r\n          document.querySelector('.div-m-timeline-slider').style.setProperty('--opacity', '0');\r\n          clearTimeout(this.running);\r\n          this.running = false;\r\n        });\r\n        const play = this.template.querySelector('#m-timeline-play');\r\n        play.addEventListener('click', (e) => this.playTimeline(false));\r\n        success(this.template);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Transform StringLayers to Mapea M.Layer\r\n   * \r\n   * WMTS*http://www.ign.es/wmts/pnoa-ma?*OI.OrthoimageCoverage*EPSG:25830*PNOA\r\n   * WMS*IGN*http://www.ign.es/wms-inspire/ign-base*IGNBaseTodo\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   * @param {string}\r\n   * @return\r\n   */\r\n  transformToLayers(layer) {\r\n    let newLayer = null;\r\n    if (!(layer instanceof Object)) {\r\n      if (layer.indexOf('*') >= 0) {\r\n        const urlLayer = layer.split('*');\r\n        if (urlLayer[0].toUpperCase() == 'WMS') {\r\n          newLayer = new M.layer.WMS({\r\n            url: urlLayer[2],\r\n            name: urlLayer[3]\r\n          });\r\n        } else if (urlLayer[0].toUpperCase() == 'WMTS') {\r\n          newLayer = new M.layer.WMTS({\r\n            url: urlLayer[2],\r\n            name: urlLayer[3]\r\n          });\r\n        }\r\n      } else {\r\n        const layerByName = this.map.getLayers().filter(l => layer.includes(l.name))[0];\r\n        newLayer = this.isValidLayer(layerByName) ? layerByName : null;\r\n      }\r\n    } else if (layer instanceof Object) {\r\n      const layerByObject = this.map.getLayers().filter(l => layer.name.includes(l.name))[0];\r\n      newLayer = this.isValidLayer(layerByObject) ? layerByObject : null;\r\n    }\r\n    if (newLayer !== null) {\r\n      newLayer.displayInLayerSwitcher = false;\r\n      newLayer.setVisible(false);\r\n      return newLayer\r\n    } else {\r\n      this.map.removeLayers(layer);\r\n    }\r\n  }\r\n\r\n  /** This function change layers and show layer name when slider moves\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   * @return\r\n   */\r\n  changeSlider(elem) {\r\n    document.querySelector('.div-m-timeline-slider').style.setProperty('--opacity', '0');\r\n    const left = (((elem.value - elem.min) / (elem.max - elem.min)) * ((256 - 5) - 5)) + 5;\r\n    document.querySelector('.div-m-timeline-slider').style.setProperty('--left', left + 'px');\r\n    if (this.animation || this.intervals[0].name !== '') {\r\n      document.querySelector('.m-timeline-names').style.display = 'block';\r\n    }\r\n    if (this.animation) {\r\n      document.querySelector('.m-timeline-button').style.display = 'block';\r\n    }\r\n    let step = parseFloat(elem.value);\r\n    this.intervals.forEach((interval) => {\r\n      this.getMapLayer(interval.service).setVisible(false);\r\n      document.querySelector('.m-timeline-names').innerHTML = '';\r\n    });\r\n    if (step % 1 == 0) {\r\n      document.querySelector('.div-m-timeline-slider').style.setProperty('--left', left + 20 + 'px');\r\n      this.getMapLayer(this.intervals[step].service).setVisible(true);\r\n      document.querySelector('.m-timeline-names').innerHTML = this.intervals[step].name;\r\n      document.querySelector('.div-m-timeline-panel').style.setProperty('--valor', '\"' + this.intervals[step].tag + '\"')\r\n      if (this.intervals[step].tag !== '') {\r\n        document.querySelector('.div-m-timeline-slider').style.setProperty('--opacity', '1');\r\n      } else {\r\n        document.querySelector('.div-m-timeline-slider').style.setProperty('--opacity', '0');\r\n      }\r\n    } else {\r\n      this.getMapLayer(this.intervals[parseInt(step)].service).setVisible(true);\r\n      this.getMapLayer(this.intervals[parseInt(step) + 1].service).setVisible(true);\r\n      if (this.intervals[parseInt(step)].tag !== '' && this.intervals[parseInt(step) + 1].tag !== '') {\r\n        document.querySelector('.div-m-timeline-slider').style.setProperty('--left', left + 'px');\r\n        document.querySelector('.div-m-timeline-slider').style.setProperty('--opacity', '1');\r\n        document.querySelector('.div-m-timeline-panel').style.setProperty('--valor', '\"' + this.intervals[parseInt(step)].tag + ' - ' + this.intervals[parseInt(step) + 1].tag + '\"');\r\n        document.querySelector('.m-timeline-names').innerHTML = this.intervals[parseInt(step)].name + ' y ' + this.intervals[parseInt(step) + 1].name;\r\n      } else if (this.intervals[parseInt(step)].tag === '' && this.intervals[parseInt(step) + 1].tag === '') {\r\n        document.querySelector('.div-m-timeline-slider').style.setProperty('--opacity', '0');\r\n      } else {\r\n        document.querySelector('.div-m-timeline-slider').style.setProperty('--left', left + 20 + 'px');\r\n        document.querySelector('.div-m-timeline-slider').style.setProperty('--opacity', '10');\r\n        document.querySelector('.m-timeline-names').innerHTML = this.intervals[parseInt(step)].name + this.intervals[parseInt(step) + 1].name;\r\n        document.querySelector('.div-m-timeline-panel').style.setProperty('--valor', '\"' + this.intervals[parseInt(step)].tag + this.intervals[parseInt(step) + 1].tag + '\"');\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /** This function search a layer in the map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   * @return\r\n   */\r\n  getMapLayer(layerSearch) {\r\n    return this.map.getLayers().filter(layer => layer.getImpl().legend === layerSearch.getImpl().legend)[0];\r\n  }\r\n\r\n  /** This function make the play animation\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   * @return\r\n   */\r\n  playTimeline(next) {\r\n    const start = 0;\r\n    const end = this.intervals.length - 1;\r\n    const slider = document.querySelector('#input-slider');\r\n    let step = parseInt(slider.value);\r\n    if (this.running) {\r\n      document.querySelector('.m-timeline-button button').classList.add('timeline-control-siguiente');\r\n      document.querySelector('.m-timeline-button button').classList.remove('timeline-control-pausa');\r\n      clearTimeout(this.running);\r\n    }\r\n    if (!next) {\r\n      if (step > start && step < end && this.running) {\r\n        this.running = false;\r\n        return;\r\n      }\r\n      if (step > end) {\r\n        step = start;\r\n      }\r\n    }\r\n    if (step >= end) {\r\n      slider.value = 0;\r\n      this.changeSlider(slider);\r\n      return;\r\n    }\r\n    if (step < start) {\r\n      step = start;\r\n    }\r\n    slider.value = parseFloat(slider.value) + 1;\r\n    this.changeSlider(slider);\r\n    document.querySelector('.m-timeline-button button').classList.remove('timeline-control-siguiente');\r\n    document.querySelector('.m-timeline-button button').classList.add('timeline-control-pausa');\r\n    this.running = setTimeout((e) => this.playTimeline(true), this.speed * 1000);\r\n  }\r\n\r\n  /**\r\n   * This function remove the timeline layers\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  removeTimelineLayers() {\r\n    clearInterval(this.running);\r\n    this.intervals.forEach((interval) => {\r\n      this.map.removeLayers(this.getMapLayer(interval.service));\r\n    })\r\n  }\r\n\r\n  /**\r\n   * This function compares controls\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Control} control to compare\r\n   * @api stable\r\n   * @return {Boolean}\r\n   */\r\n  equals(control) {\r\n    return control instanceof TimelineControl;\r\n  }\r\n\r\n  // ++ timeLineDinamic\r\n  /**\r\n   * Create TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n   */\r\n  createtimeLineDinamic() {\r\n    this.createStepsTimeLine();\r\n    this.createSelectorLayers();\r\n    this.createInputDate();\r\n  }\r\n\r\n  /**\r\n   * Create input date TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n   */\r\n  createInputDate(){\r\n    const init = this.template.querySelector('#init');\r\n    const end = this.template.querySelector('#end');\r\n\r\n    init.value = this.date.init;\r\n    end.value = this.date.end;\r\n\r\n    ['focusout', 'keypress'].forEach((event) => {\r\n      init.addEventListener(event, ({ target, key = false } = {}) => {\r\n        if(event === 'focusout' || key === 'Enter') {\r\n          const value = this.getValues_inputDate(target.value);\r\n          const endValue = this.getValues_inputDate(end.value);\r\n          this.changeDateLayer(new Date(target.value).getTime(), new Date(end.value).getTime());\r\n          this.changeValueSlider(value, endValue);\r\n        }\r\n      });\r\n\r\n      end.addEventListener(event, ({ target, key = false } = {}) => {\r\n        if(event === 'focusout' || key === 'Enter') {\r\n        const value = this.getValues_inputDate(target.value);\r\n        const valueInit = this.getValues_inputDate(init.value);\r\n        this.changeDateLayer(new Date(init.value).getTime(), new Date(target.value).getTime());\r\n        this.changeValueSlider(valueInit, value);\r\n        }\r\n      });\r\n    })\r\n  }\r\n\r\n   /**\r\n   * Create selector layers TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n   */\r\n  createSelectorLayers() {\r\n    const selectDinamic = this.template.querySelector('#selectDinamicLayer');\r\n    this.intervals.forEach(({ id, init, end, layer, grupo, attributeParam, equalsTimeLine = false }) => {\r\n\r\n      if(!equalsTimeLine) {\r\n        equalsTimeLine = (this.timelineType === 'absolute') ? true : false;\r\n      }\r\n\r\n      const l = this.transformToLayersDinamic({ init, end }, layer, id, attributeParam, equalsTimeLine);\r\n      if (grupo) {\r\n        const layerGroup = this.allLayersDinamic.groupLayer.find(({ name }) => name === grupo);\r\n\r\n        if (layerGroup) {\r\n          const lastGroup = selectDinamic.querySelector(`#${grupo}`);\r\n\r\n          const lastGroup_init = lastGroup.getAttribute('init');\r\n          const lastGroup_end = lastGroup.getAttribute('end');\r\n\r\n          lastGroup.setAttribute('init', (new Date(lastGroup_init).getTime() < new Date(init).getTime()) ? lastGroup_init : init);\r\n          lastGroup.setAttribute('end', (new Date(lastGroup_end).getTime() > new Date(end).getTime()) ? lastGroup_end : end);\r\n\r\n          layerGroup.layers.push(l);\r\n        } else {\r\n          this.allLayersDinamic.groupLayer.push({\r\n            name: grupo,\r\n            layers: [l]\r\n          });\r\n          selectDinamic.innerHTML += `<option id=\"${grupo}\" equalsTimeLine=\"${equalsTimeLine}\" init=\"${init}\" end=\"${end}\" value=\"group\">${grupo}</option>`;\r\n        }\r\n      } else {\r\n        this.allLayersDinamic.noGroupLayer.push({\r\n          name: l.name,\r\n          layers: [l]\r\n        })\r\n        selectDinamic.innerHTML += `<option id=\"${id}\" equalsTimeLine=\"${equalsTimeLine}\" init=\"${init}\" end=\"${end}\" value=\"${id}\">${l.name}</option>`\r\n      }\r\n    });\r\n    this.selectorEventLayer();\r\n  }\r\n\r\n  /**\r\n   * Create steps TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  createStepsTimeLine() {\r\n    this.template.querySelector('#m-timelineDinamic-play').addEventListener('click', ({ target }) => {\r\n      const active = target.classList.contains('active');\r\n      if (!active) {\r\n        const id = this.stepsTimeLineDinamic();\r\n        target.classList.add('active')\r\n        target.setAttribute('intervalID', id);\r\n      } else {\r\n        clearInterval(target.getAttribute('intervalID'));\r\n        target.classList.remove('active');\r\n      }\r\n    });\r\n\r\n    [this.template.querySelector('#m-timelineDinamic-back'),\r\n    this.template.querySelector('#m-timelineDinamic-before')].forEach(l => {\r\n    l.addEventListener('click', ({ target }) => {\r\n      this.evtFormatMove(target.id);\r\n    })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Search Layers Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  searchLayerDinamic(layer) {\r\n    return this.intervals.filter(({ id }) => layer.id === id)[0];\r\n  }\r\n\r\n  /**\r\n   * Return layers filter Date\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  transformToLayersDinamic({ init, end }, layer, id, attributeParam, equalsTimeLine) {\r\n    if (!(layer instanceof Object)) {\r\n      const [type, legend, url, name] = layer.split('*');\r\n      const layerWMS = new M.layer.WMS(\r\n        { type, legend, url, name },\r\n        { params: { CQL_FILTER: (equalsTimeLine) ? \r\n          `${attributeParam} = '${new Date(end).toISOString()}'`\r\n          : `${attributeParam} DURING ${new Date(init).toISOString()}/${new Date(end).toISOString()}` } }\r\n      );\r\n      layerWMS.id = id;\r\n      layerWMS.layerTimeLine = true;\r\n      layerWMS.attributeParam = attributeParam;\r\n      layerWMS.equalsTimeLine = equalsTimeLine;\r\n      return layerWMS;\r\n    } else {\r\n      if ((layer instanceof M.layer.Vector)) {\r\n        layer.layerTimeLine = true;\r\n        layer.id = id;\r\n        layer.attributeParam = attributeParam;\r\n        layer.equalsTimeLine = equalsTimeLine;\r\n        return layer;\r\n      } else {\r\n        // WMS\r\n        layer.layerTimeLine = true;\r\n        layer.id = id;\r\n        layer.attributeParam = attributeParam;\r\n        layer.equalsTimeLine = equalsTimeLine;\r\n        return layer;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Return Date Input Format\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getValues_inputDate(value){\r\n    const format = this.formatValue;\r\n    const formatRevert = this.getReverseFormat(format);\r\n    const dateToNumber = new Date(value).getTime();\r\n    return this.getFormatValue(dateToNumber, formatRevert);\r\n  }\r\n\r\n  /**\r\n   * Event to Selector Layer TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  selectorEventLayer() {\r\n    const selectDinamic = this.template.querySelector('#selectDinamicLayer');\r\n    selectDinamic.addEventListener('change', ({ target }) => {\r\n      this.removeLayers();\r\n\r\n      if (target.selectedIndex === 0) {\r\n        this.changeValueInputDate('Please choose an option', 'Please choose an option');\r\n        this.sliderEventDinamic(0, 1);\r\n        return;\r\n      }\r\n\r\n      const selected = target.children[target.selectedIndex];\r\n\r\n      const init = selected.getAttribute('init');\r\n      const end = selected.getAttribute('end');\r\n      const equalsTimeLine = selected.getAttribute('equalsTimeLine');\r\n\r\n      if(equalsTimeLine === 'true') {\r\n        document.querySelector('#a').setAttribute('disabled','');\r\n        document.querySelector('#init').setAttribute('disabled','');\r\n      } else {\r\n        document.querySelector('#a').removeAttribute('disabled');\r\n        document.querySelector('#init').removeAttribute('disabled');\r\n      }\r\n\r\n      if (selected.value === 'group') {\r\n        const layerGroup = this.allLayersDinamic.groupLayer.find(({ name }) => name === selected.id);\r\n        this.map.addLayers(layerGroup.layers);\r\n        this.changeVectorLayer(new Date(init).getTime(), new Date(end).getTime(), layerGroup.layers);\r\n\r\n        this.changeValueInputDate(init, end);\r\n        this.sliderEventDinamic(new Date(init).getTime(), new Date(end).getTime());\r\n      } else {\r\n        const layerNoGroup = this.allLayersDinamic.noGroupLayer.find(({ name, layers }) => layers[0].id === selected.id);\r\n\r\n        this.map.addLayers(layerNoGroup.layers);\r\n        this.changeVectorLayer(new Date(init).getTime(), new Date(end).getTime(), layerNoGroup.layers);\r\n\r\n        this.changeValueInputDate(init, end);\r\n        this.sliderEventDinamic(new Date(init).getTime(), new Date(end).getTime());\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Remove Layer TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  removeLayers() {\r\n    const removeLayers = this.map.getLayers().filter((l) => l.layerTimeLine === true);\r\n    this.map.removeLayers(removeLayers);\r\n  }\r\n\r\n  /**\r\n   * Get Layers TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getLayerTimeLine() {\r\n    return this.map.getLayers().filter((l) => l.layerTimeLine === true);\r\n  }\r\n\r\n  /**\r\n   * Event Slider TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  sliderEventDinamic(init, end) {\r\n    this.generateValueSlider(init, end);\r\n\r\n    this.template.querySelector('.wrap #a').addEventListener('input', ({ target }) => {\r\n      const inputvalue = Number(document.querySelector('.wrap #b').value);\r\n      if(Number(target.value)>=inputvalue) {\r\n        target.value = inputvalue;\r\n        return;\r\n      } \r\n\r\n      const formatValue = this.formatValue\r\n      const valueInit = this.getFormatValue(Number(target.value), formatValue);\r\n      const valueEnd = this.getFormatValue(Number(inputvalue), formatValue);\r\n    \r\n      this.changeDateLayer(valueInit, valueEnd);\r\n      this.changeValueInputDate(new Date(valueInit).toISOString(), new Date(valueEnd).toISOString());\r\n    })\r\n\r\n    this.template.querySelector('.wrap #b').addEventListener('input', ({ target }) => {\r\n      const inputvalue = Number(document.querySelector('.wrap #a').value);\r\n      if(Number(target.value)<=inputvalue) {\r\n        target.value = inputvalue;\r\n        return;\r\n      }      \r\n \r\n      const formatValue = this.formatValue\r\n      const valueEnd = this.getFormatValue(Number(target.value), formatValue);\r\n      const valueInit = this.getFormatValue(Number(inputvalue), formatValue);\r\n\r\n      this.changeDateLayer(valueInit, valueEnd);\r\n      this.changeValueInputDate(new Date(valueInit).toISOString(), new Date(valueEnd).toISOString());\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Generate Values Slider TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  generateValueSlider(init, end){\r\n    const inputInit = this.template.querySelector('.wrap #a');\r\n    const inputEnd =  this.template.querySelector('.wrap #b');\r\n\r\n    const dateInit = new Date(init).getTime();\r\n    const dateEnd = new Date(end).getTime();\r\n\r\n\r\n    inputInit.min = dateInit;\r\n    inputInit.max = dateEnd;\r\n    inputInit.value = dateInit;\r\n\r\n    inputEnd.min = dateInit;\r\n    inputEnd.max = dateEnd;\r\n    inputEnd.value = dateEnd;\r\n  }\r\n\r\n  /**\r\n   * Change Value Input Date TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  changeValueInputDate(init, end) {\r\n    this.template.querySelector('#init').value = init;\r\n    this.template.querySelector('#end').value = end;\r\n  }\r\n\r\n  /**\r\n   * Change Value Slider TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  changeValueSlider(init, end) {\r\n    this.template.querySelectorAll('.wrap input')[0].value = init;\r\n    this.template.querySelectorAll('.wrap input')[1].value = end;\r\n  }\r\n\r\n  /**\r\n   * Change Date Layer TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  changeDateLayer(init, end) {\r\n    let initValue = Number(init);\r\n    let endValue = Number(end);\r\n\r\n    const layersTimeLine = this.getLayerTimeLine();\r\n    this.removeLayers();\r\n\r\n    layersTimeLine.forEach(l => {\r\n      if (l instanceof M.layer.Vector) {\r\n        l.on(M.evt.LOAD, () => {\r\n          const searhDinamic = this.searchLayerDinamic(l);\r\n          const [vectorInitValue, vectorEndValue] = this.getGroupLimit(initValue, endValue, searhDinamic);\r\n\r\n          const filter = new M.filter.Function(f => {\r\n            const dateTime = f.getAttributes()[l.attributeParam];\r\n            if(l.equalsTimeLine) {\r\n              if(vectorEndValue === new Date(this.transformTime_NumbToDate(dateTime)[0]).getTime()) return f;\r\n            } else {\r\n              if (vectorInitValue <= new Date(this.transformTime_NumbToDate(dateTime)[0]).getTime()\r\n              && vectorEndValue >= new Date(this.transformTime_NumbToDate(dateTime)[0]).getTime()) return f;\r\n            }\r\n          });\r\n\r\n          l.setFilter(filter);\r\n        })\r\n\r\n      } else {\r\n        const searhDinamic = this.searchLayerDinamic(l);\r\n        const [wmsInitValue, wmsEndValue] = this.getGroupLimit(initValue, endValue, searhDinamic);\r\n        l.options.params.CQL_FILTER = (l.equalsTimeLine) ? \r\n        `${l.attributeParam} = '${new Date(end).toISOString()}'`\r\n        : `${l.attributeParam} DURING ${new Date(wmsInitValue).toISOString()}/${new Date(wmsEndValue).toISOString()}`;\r\n      }\r\n      this.map.addLayers(l);\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Vector Layer Change Date TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  changeVectorLayer(init, end, layers) {\r\n    const vectorLayers = layers.filter((l) => l instanceof M.layer.Vector);\r\n    vectorLayers.forEach((l) => {\r\n\r\n      l.on(M.evt.LOAD, () => {\r\n        const searhDinamic = this.searchLayerDinamic(l);\r\n        const [vectorInitValue, vectorEndValue] = this.getGroupLimit(init, end, searhDinamic);\r\n\r\n        const filter = new M.filter.Function(f => {\r\n          const dateTime = f.getAttributes()[l.attributeParam];\r\n          if(l.equalsTimeLine) {\r\n            if(vectorEndValue === new Date(this.transformTime_NumbToDate(dateTime)[0]).getTime()) return f;\r\n          } else {\r\n            if (vectorInitValue <= new Date(this.transformTime_NumbToDate(dateTime)[0]).getTime()\r\n            && vectorEndValue >= new Date(this.transformTime_NumbToDate(dateTime)[0]).getTime()) return f;\r\n          }\r\n        });\r\n\r\n        l.setFilter(filter);\r\n      })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Continuous Event Back \r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  evtFormatMove(id){\r\n    if(this.template.querySelector('#selectDinamicLayer').value === ''){\r\n      this.changeValueInputDate('Please choose an option', 'Please choose an option');\r\n      this.sliderEventDinamic(0, 1);\r\n      return;\r\n    }\r\n\r\n    const format = this.formatValue;\r\n    const formatRevert = this.getReverseFormat(format);\r\n\r\n    const [dateInit, dateEnd] = this.getValueDateInput().map((numberIntEnd, i) => {\r\n      if(i === 0 && this.formatMove === 'discrete') {\r\n        return numberIntEnd\r\n      }else {\r\n        if(id === 'm-timelineDinamic-before') {\r\n          const sliderMax = this.getValueSliderB().max;\r\n          return this.getValueBeforeEvent(numberIntEnd, sliderMax);\r\n        }else {\r\n          const sliderMin = this.getValueSliderB().min;\r\n          return this.getValueBackEvent(numberIntEnd, sliderMin);\r\n        }\r\n      }\r\n\r\n    });\r\n\r\n    this.changeValueInputDate(new Date(dateInit).toISOString(), new Date(dateEnd).toISOString());\r\n    const [reverseInit, reverseEnd] = [dateInit, dateEnd].map(n => this.getFormatValue(n, formatRevert))\r\n\r\n    this.changeDateLayer(dateInit, dateEnd);\r\n    this.changeValueSlider(reverseInit, reverseEnd);\r\n  }\r\n\r\n  /**\r\n   * Get Value Back Event\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getValueBackEvent(value,sliderMin){\r\n    return ((value - this.getStepValue()) <= sliderMin) \r\n    ? sliderMin\r\n    : value - this.getStepValue();\r\n  }\r\n\r\n  /**\r\n   * Reverse Format TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getReverseFormat(format){\r\n    const formatValue = format;\r\n    if(formatValue === 'logarithmic') return 'exponential';\r\n    if(formatValue === 'exponential') return 'logarithmic';\r\n    return 'linear'\r\n  }\r\n\r\n  /**\r\n   * Before Event Get Values\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getValueBeforeEvent(number, sliderMax) {\r\n    return ((number + this.getStepValue()) >= sliderMax) \r\n    ? sliderMax \r\n    : number + this.getStepValue();\r\n  }\r\n\r\n  /**\r\n   * Get Value Date Input\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getValueDateInput(){\r\n    const init = document.querySelector('#init').value;\r\n    const end = document.querySelector('#end').value;\r\n    return [new Date(init).getTime(), new Date(end).getTime()];\r\n  }\r\n\r\n  /**\r\n   * Get Format Value\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getFormatValue(value, format){\r\n    const sliderMax = Number(document.querySelector('#b').max);\r\n    const sliderMin = Number(document.querySelector('#b').min);\r\n\r\n    const formatValue = format; \r\n    if (formatValue ===   'exponential') {\r\n      return this.exponential( sliderMin, sliderMax, value)\r\n    } else if(formatValue === 'logarithmic'){\r\n      return this.logarithmic( sliderMin, sliderMax, value)\r\n    }else {\r\n      return value;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Get Value Slider B\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getValueSliderB(){\r\n    return {\r\n      min: Number(document.querySelector('#b').min),\r\n      max: Number(document.querySelector('#b').max),\r\n      value: Number(document.querySelector('#b').value),\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get Value Slider A\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getValueSliderA(){\r\n    return {\r\n      min: Number(document.querySelector('#a').min),\r\n      max: Number(document.querySelector('#a').max),\r\n      value: Number(document.querySelector('#a').value),\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Step TimeLine Dinamic\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  stepsTimeLineDinamic() {\r\n    if(this.template.querySelector('#selectDinamicLayer').value === ''){\r\n      this.changeValueInputDate('Please choose an option', 'Please choose an option');\r\n      this.sliderEventDinamic(0, 1);\r\n      return;\r\n    }\r\n\r\n    const speed = this.speedDate;\r\n\r\n    const time = setInterval(() => {\r\n        this.evtFormatMove('m-timelineDinamic-before');\r\n    }, 1000 * speed);\r\n\r\n    return time;\r\n  }\r\n\r\n  /**\r\n   * Get Value Step\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getStepValue() {\r\n    const date = this.paramsDate;\r\n    switch (date) {\r\n      case 'sec':\r\n        return 1000 * this.stepValue;\r\n\r\n      case 'min':\r\n        return (1000 * 60) * this.stepValue;\r\n\r\n      case 'hrs':\r\n        return (1000 * 60 * 60) * this.stepValue;\r\n\r\n      case 'day':\r\n        return (1000 * 60 * 60 * 24) * this.stepValue;\r\n\r\n      case 'mos':\r\n        return (1000 * 60 * 60 * 24 * 30) * this.stepValue;\r\n\r\n      case 'yr':\r\n        return (1000 * 60 * 60 * 24 * 30 * 12) * this.stepValue;\r\n\r\n      default:\r\n        return 86400000; // day in ms\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get Limit Group\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  getGroupLimit(init, end, userValues) {\r\n    const initValue = (init <= new Date(userValues.init).getTime()) ? new Date(userValues.init).getTime() : init;\r\n    const endValues = (end >= new Date(userValues.end).getTime()) ? new Date(userValues.end).getTime() : end;\r\n    return [initValue, endValues];\r\n  }\r\n\r\n  /**\r\n   * Transform Time/Number to Date\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  transformTime_NumbToDate(init = 0, end = 0) {\r\n    init = (isNaN(Number(init))) ? new Date(init).toISOString() : new Date(Number(init)).toISOString();\r\n    end = (isNaN(Number(end))) ? new Date(end).toISOString() : new Date(Number(end)).toISOString();\r\n    return [init, end];\r\n  }\r\n\r\n  /**\r\n   * Logarithmic Formt\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n   logarithmic(min, max, val) {\r\n    const [minv, ,scale] = this.formatValueType(min, max);\r\n\r\n    if (min > 0) {\r\n      return Math.round(Math.exp(minv - min * scale + scale * val));\r\n    } else {\r\n      return Math.round(Math.exp(-min * scale) * (Math.exp(minv + scale * val) + min * Math.exp(min * scale) - Math.exp(min * scale)));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Type Format Value\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n  formatValueType(min, max){\r\n    const fristDate = min;\r\n    const endDate = max;\r\n\r\n    let minv = 0;\r\n    let maxv = 0;\r\n\r\n    if (fristDate > 0) {\r\n      minv = Math.log(fristDate);\r\n      maxv = Math.log(endDate);\r\n    } else {\r\n      minv = Math.log(1);\r\n      maxv = Math.log(endDate + Math.abs(fristDate) + 1);\r\n    }\r\n\r\n    const scale = (maxv - minv) / (endDate - fristDate);\r\n    return [minv, maxv, scale];\r\n  }\r\n\r\n  /**\r\n   *  Exponentialformar\r\n   *\r\n   * @private\r\n   * @function\r\n  */\r\n   exponential(min, max, val) {\r\n    const [minv, ,scale] = this.formatValueType(min, max);\r\n\r\n    if (min > 0) {\r\n      return Math.round((Math.log( val)  - minv) / scale + min)\r\n    \r\n    }else{\r\n      return Math.round((Math.log( (val - min +1))  - minv) / scale + min)\r\n    }\r\n  }\r\n}","/**\r\n * @module M/plugin/Timeline\r\n */\r\nimport 'assets/css/timeline';\r\nimport TimelineControl from './timelinecontrol';\r\nimport api from '../../api';\r\nimport { getValue } from './i18n/language';\r\n\r\nimport es from './i18n/es';\r\nimport en from './i18n/en';\r\n\r\nexport default class Timeline extends M.Plugin {\r\n  /**\r\n   * @classdesc\r\n   * Main facade plugin object. This class creates a plugin\r\n   * object which has an implementation Object\r\n   *\r\n   * @constructor\r\n   * @extends {M.Plugin}\r\n   * @param {Object} impl implementation object\r\n   * @api stable\r\n   */\r\n  constructor(options = {}) {\r\n    super();\r\n\r\n    /**\r\n     * Name plugin\r\n     * @private\r\n     * @type {String}\r\n     */\r\n    this.name_ = 'timeline';\r\n\r\n    /**\r\n     * Facade of the map\r\n     * @private\r\n     * @type {M.Map}\r\n     */\r\n    this.map_ = null;\r\n\r\n    /**\r\n     * Array of controls\r\n     * @private\r\n     * @type {Array<M.Control>}\r\n     */\r\n    this.controls_ = [];\r\n\r\n    /**\r\n     * Class name of the html view Plugin\r\n     * @public\r\n     * @type {string}\r\n     */\r\n    this.className = 'm-plugin-timeline';\r\n\r\n    /**\r\n     * Position of the Plugin\r\n     * @public\r\n     * Posible values: TR | TL | BL | BR\r\n     * @type {String}\r\n     */\r\n    const positions = ['TR', 'TL', 'BL', 'BR'];\r\n    this.position = positions.includes(options.position) ? options.position : 'TR';\r\n\r\n    /**\r\n     * Intervals\r\n     * @public\r\n     * Value: Array with each interval attributes [name, tag, service]\r\n     * @type {String}\r\n     */\r\n    if (options !== undefined) {\r\n      if (M.utils.isString(options.intervals)) {\r\n        this.intervals = JSON.parse(options.intervals.replace(/!!/g, '[').replace(/Â¡Â¡/g, ']'));\r\n      } else if (M.utils.isArray(options.intervals)) {\r\n        this.intervals = options.intervals;\r\n      } else {\r\n        // M.dialog.error(getValue('intervals_error'));\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Animation of the timeline\r\n     * @public\r\n     * Value: true / false\r\n     * @type {boolean}\r\n     */\r\n    this.animation = options.animation;\r\n    if (this.animation === undefined) this.animation = true;\r\n\r\n    /**\r\n     * Speed of animation\r\n     * @public\r\n     * Value: 1 - 100\r\n     * @type {number}\r\n     */\r\n    this.speed = parseFloat(options.speed) || 1;\r\n\r\n    /**\r\n     * Metadata from api.json\r\n     * @private\r\n     * @type {Object}\r\n     */\r\n    this.metadata_ = api.metadata;\r\n\r\n    /**\r\n     *@private\r\n     *@type { string }\r\n     */\r\n    this.tooltip_ = options.tooltip || getValue('tooltip');\r\n\r\n    /**\r\n     *@private\r\n     *@type { Number }\r\n     */\r\n    this.speedDate = (options.speedDate) ? options.speedDate : 2;\r\n\r\n    /**\r\n     *@private\r\n     *@type { String }\r\n     */\r\n     this.paramsDate = (options.paramsDate) ? options.paramsDate : 'yr';\r\n\r\n    /**\r\n     *@private\r\n     *@type { Number }\r\n     */\r\n     this.stepValue = (options.stepValue) ? options.stepValue : 1;\r\n\r\n    /**\r\n     *@private\r\n     *@type { String }\r\n     */\r\n     this.sizeWidthDinamic = (options.sizeWidthDinamic) ? options.sizeWidthDinamic : ''\r\n\r\n      /**\r\n     *@private\r\n     *@type { String }\r\n     */\r\n     this.formatMove = (options.formatMove === 'discrete') ? 'discrete' : 'continuous';\r\n\r\n    /**\r\n     *@private\r\n     *@type { String }\r\n     */\r\n     this.formatValue = (options.formatValue) ? options.formatValue : 'linear';\r\n\r\n    /**\r\n     *@private\r\n     *@type { String }\r\n     */\r\n     this.timelineType = options.timelineType || false;\r\n\r\n  }\r\n\r\n  /**\r\n   * Return plugin language\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {string} lang type language\r\n   * @api stable\r\n   */\r\n   static getJSONTranslations(lang) {\r\n    if (lang === 'en' || lang === 'es') {\r\n      return (lang === 'en') ? en : es;\r\n    }\r\n    return M.language.getTranslation(lang).timeline;\r\n  }\r\n\r\n  /**\r\n   * This function adds this plugin into the map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map the map to add the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map) {\r\n    const typesTimeline = ['absoluteSimple', 'absolute', 'relative']\r\n    if(!this.timelineType || !typesTimeline.includes(this.timelineType)) {\r\n       throw new Error ('Add correct typesTimeline, (absoluteSimple', 'absolute', 'relative)');\r\n    }\r\n\r\n    this.control_ = new TimelineControl({\r\n      intervals: this.intervals,\r\n      animation: this.animation,\r\n      speed: this.speed,\r\n      speedDate: this.speedDate,\r\n      paramsDate: this.paramsDate,\r\n      stepValue: this.stepValue,\r\n      sizeWidthDinamic: this.sizeWidthDinamic,\r\n      formatMove: this.formatMove,\r\n      formatValue: this.formatValue,\r\n      timelineType: this.timelineType\r\n    });\r\n    this.controls_.push(this.control_);\r\n    this.map_ = map;\r\n    this.panel_ = new M.ui.Panel('panelTimeline', {\r\n      collapsible: true,\r\n      position: M.ui.position[this.position],\r\n      className: this.className,\r\n      collapsedButtonClass: 'timeline-gestion-reloj2',\r\n      tooltip: this.tooltip_,\r\n    });\r\n    this.panel_.addControls(this.controls_);\r\n    map.addPanels(this.panel_);\r\n  }\r\n\r\n\r\n  /**\r\n   * This function destroys this plugin\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  destroy() {\r\n    if(['absolute', 'relative'].includes(this.timelineType)) {\r\n      this.control_.removeLayers()\r\n    }else {\r\n      this.control_.removeTimelineLayers();\r\n    }\r\n\r\n    this.map_.removeControls([this.control_]);\r\n    [this.control_, this.panel_, this.map_, this.layers, this.radius] = [null, null, null, null, null];\r\n  }\r\n\r\n  /**\r\n   * This function gets name plugin\r\n   * @getter\r\n   * @public\r\n   * @returns {string}\r\n   * @api stable\r\n   */\r\n  get name() {\r\n    return this.name_;\r\n  }\r\n\r\n  /**\r\n   * This function gets metadata plugin\r\n   *\r\n   * @public\r\n   * @getter\r\n   * @api stable\r\n   * @return {Object}\r\n   */\r\n  getMetadata() {\r\n    return this.metadata_;\r\n  }\r\n\r\n  /**\r\n   * Get the API REST Parameters of the plugin\r\n   *\r\n   * @function\r\n   * @public\r\n   * @api\r\n   */\r\n  getAPIRest() {\r\n    const intervals = JSON.stringify(this.intervals).replace(/\\[/g, '!!').replace(/\\]/g, 'Â¡Â¡');\r\n    return `${this.name}=${this.position}*!${intervals}*!${this.animation}*!${this.speed}`;\r\n  }\r\n\r\n  /**\r\n   * Activate plugin\r\n   *\r\n   * @function\r\n   * @public\r\n   * @api\r\n   */\r\n  activate() {\r\n    this.control_.activate();\r\n  }\r\n\r\n  /**\r\n   * Desactivate plugin\r\n   *\r\n   * @function\r\n   * @public\r\n   * @api\r\n   */\r\n  deactivate() {\r\n    this.control_.deactivate();\r\n  }\r\n\r\n  /**\r\n   * This\r\n   function compare\r\n   if pluging recieved by param is instance of M.plugin.Timeline\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.plugin} plugin to compare\r\n   * @api stable\r\n   */\r\n  equals(plugin) {\r\n    if (plugin instanceof Timeline) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","import M$plugin$Timeline from '/home/carmenmarquez/Escritorio/nuevaEntrega/API-CNIG/api-ign-js/src/plugins/timeline/src/facade/js/timeline';\nimport M$control$TimelineControl from '/home/carmenmarquez/Escritorio/nuevaEntrega/API-CNIG/api-ign-js/src/plugins/timeline/src/facade/js/timelinecontrol';\nimport M$impl$control$TimelineControl from '/home/carmenmarquez/Escritorio/nuevaEntrega/API-CNIG/api-ign-js/src/plugins/timeline/src/impl/ol/js/timelinecontrol';\n\nif (!window.M.plugin) window.M.plugin = {};\nif (!window.M.control) window.M.control = {};\nif (!window.M.impl) window.M.impl = {};\nif (!window.M.impl.control) window.M.impl.control = {};\nwindow.M.plugin.Timeline = M$plugin$Timeline;\nwindow.M.control.TimelineControl = M$control$TimelineControl;\nwindow.M.impl.control.TimelineControl = M$impl$control$TimelineControl;\n"],"sourceRoot":""}