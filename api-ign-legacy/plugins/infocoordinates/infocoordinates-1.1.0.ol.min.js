!function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=6)}([function(t){t.exports=JSON.parse('{"exception":{"impl":"The implementation used cannot create Infocoordinates controls."},"tooltip":"Coordinates Information","title":"Coordinates Information","point":"Point:","datum":"Datum:","latitude":"Latitude:","longitude":"Longitude:","formatCoordinates":"DMS","coordX":"Coord.X (m):","coordY":"Coord.Y (m):","altitude":"Altitude (m):","readingAltitude":"Reading...","noDatafromWCS":"No data","removePoint":"Removes point","copyLatLon":"Copy latitude/longitude","copyxy":"Copy x/y","removeAllPoints":"Remove all points","importAllPoints":"Export all points","copyAllPoints":"Copy all points","displayONAllPoints":"Show coordinates of all points","displayOFFAllPoints":"Hide coordinates of all points","clipboard":"Result copied to clipboard"}')},function(t){t.exports=JSON.parse('{"exception":{"impl":"La implementación no puede crear controles de Infocoordinates"},"tooltip":"Información Coordenadas","title":"Información Coordenadas","point":"Punto:","datum":"Datum:","latitude":"Latitud:","longitude":"Longitud:","formatCoordinates":"GMS","coordX":"Coord.X (m):","coordY":"Coord.Y (m):","altitude":"Altitud (m):","readingAltitude":"Consultando...","noDatafromWCS":"Sin datos","removePoint":"Elimina el punto","copyLatLon":"Copiar latitud/longitud","copyxy":"Copiar x/y","removeAllPoints":"Elimina todos los puntos","importAllPoints":"Exportar todos los puntos","copyAllPoints":"Copiar todos los puntos","displayONAllPoints":"Mostrar coordenadas de todos los puntos","displayOFFAllPoints":"Ocultar coordenadas de todos los puntos","clipboard":"Resultado copiado al portapapeles"}')},function(t,e){t.exports='<div class="m-control m-container m-infocoordinates">\r\n\r\n    <div class="div-m-infocoordinates-panel">\r\n\r\n        <div role="heading" tabindex="0" class="m-infocoordinates-title">\r\n            <p id="titleInfo" class="m-infocoordinates-titleInfo">{{translations.title}}</p>\r\n        </div>\r\n\r\n        <div class="m-infocoordinates-content">\r\n            \x3c!-- Tabs --\x3e\r\n            <div class="m-infocoordinates-tabs">\r\n\r\n            </div>\r\n\r\n            \x3c!-- Tab content --\x3e\r\n            <div id="tabContent" class=\'m-infocoordinates-tabContent\'>\r\n                <table>\r\n                    <tbody>\r\n                        <tr tabindex="0">\r\n                            <td>{{translations.point}}</td>\r\n                            <td id="m-infocoordinates-point">--</td>\r\n                            <td><button type="button" tabindex="0" class="icon-bin2 noDisplay" id="m-infocoordinates-buttonRemovePoint" title="{{translations.removePoint}}"></button></td>\r\n                        </tr>\r\n                        <tr tabindex="0">\r\n                            <td>{{translations.datum}}</td>\r\n                            <td id="m-infocoordinates-datum" colspan="2">ETRS89</td>\r\n                        </tr>\r\n                        <tr tabindex="0">\r\n                            <td>{{translations.latitude}}</td>\r\n                            <td id="m-infocoordinates-latitude" colspan="2">--</td>\r\n                            <td><button type="button" tabindex="0" class="icon-copy noDisplay" id="m-infocoordinates-copylatlon" title="{{translations.copyLatLon}}"></button></td>\r\n                        <tr tabindex="0">\r\n                            <td>{{translations.longitude}}</td>\r\n                            <td id="m-infocoordinates-longitude" colspan="2">--</td>\r\n                        </tr>\r\n                        <tr tabindex="0">\r\n                            <td></td>\r\n                            <td><input tabindex="0" id="m-infocoordinates-buttonConversorFormat" type="checkbox" disabled>{{translations.formatCoordinates}}</td>\r\n                            <td></td>\r\n                        </tr>\r\n                        <tr tabindex="0">\r\n                            <td class="m-infocoordinates-help-td">\r\n                                <span>CRS:</span>\r\n                                {{#if hasHelp}}\r\n                                    <div role="navigation" class="m-infocoordinates-help" title="EPSG"><a tabindex="0" title="Help" href="{{helpUrl}}" target="_blank"><i class="icon-help"></i></a></div>\r\n                                {{/if}}\r\n                            </td>\r\n                            <td colspan="2">\r\n                                <select tabindex="0" id="m-infocoordinates-comboDatum" class="m-infocoordinates-comboDatum">\r\n                                    <option value="EPSG:25829">EPSG:25829</option>\r\n                                    <option value="EPSG:25830" selected>EPSG:25830</option>\r\n                                    <option value="EPSG:25831">EPSG:25831</option>\r\n                                    <option value="EPSG:3857">EPSG:3857</option>\r\n                                    <option value="EPSG:4083">EPSG:4083</option>\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr tabindex="0">\r\n                            <td>{{translations.coordX}}</td>\r\n                            <td id="m-infocoordinates-coordX" colspan="2">--</td>\r\n                            <td><button type="button" tabindex="0" class="icon-copy noDisplay" id="m-infocoordinates-copyxy" title="{{translations.copyxy}}"></button></td>\r\n                        </tr>\r\n                        <tr tabindex="0">\r\n                            <td>{{translations.coordY}}</td>\r\n                            <td id="m-infocoordinates-coordY" colspan="2">--</td>\r\n                        </tr>\r\n                        <tr tabindex="0">\r\n                            <td>{{translations.altitude}}</td>\r\n                            <td id="m-infocoordinates-altitude" colspan="2">--</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n            <div class="m-infocoordinates-div-buttonRemoveAllPoints noDisplay">\r\n                <button type="button" tabindex="0" class="icon-bin2" id="m-infocoordinates-buttonRemoveAllPoints" title="{{translations.removeAllPoints}}"></button>\r\n            </div>\r\n\r\n            <div class="m-infocoordinates-div-buttonImportAllPoints noDisplay">\r\n                <button type="button" tabindex="0" class="icon-file" id="m-infocoordinates-buttonImportAllPoints" title="{{translations.importAllPoints}}"></button>\r\n            </div>\r\n\r\n            <div class="m-infocoordinates-div-buttonCopyAllPoints noDisplay">\r\n                <button type="button" tabindex="0" class="icon-copy" id="m-infocoordinates-buttonCopyAllPoints" title="{{translations.copyAllPoints}}"></button>\r\n            </div>\r\n\r\n            <div class="m-infocoordinates-div-buttonDisplayAllPoints noDisplay">\r\n                <button type="button" tabindex="0" class="icon-displayON" id="m-infocoordinates-buttonDisplayAllPoints" title="{{translations.displayONAllPoints}}"></button>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n\r\n</div>'},function(t){t.exports=JSON.parse('{"url":{"name":"infocoordinates","separator":"*"},"constructor":"M.plugin.Infocoordinates","parameters":[{"type":"object","properties":[{"type":"simple","name":"position","position":0},{"type":"boolean","name":"collapsed","position":1},{"type":"boolean","name":"collapsible","position":2},{"type":"simple","name":"tooltip","position":3},{"type":"simple","name":"decimalGEOcoord","position":4},{"type":"simple","name":"decimalUTMcoord","position":5},{"type":"simple","name":"helpUrl","position":6},{"type":"simple","name":"outputDownloadFormat","position":7}]}],"files":{"ol":{"scripts":["infocoordinates.ol.min.js"],"styles":["infocoordinates.ol.min.css"]}},"metadata":{"name":"Infocoordinates","description":"Show coordinates points when clicked on map","text":"Show coordinates points when clicked on map. Change its SRC and format decimal or DMS","version":"1.1.0","date":"May, 2020","author":"","org":"","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg"}}')},function(t,e,o){},function(t,e,o){},function(t,e,o){"use strict";o.r(e);o(4),o(5);function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,a=void 0,a=function(t,e){if("object"!==n(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,e||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===n(a)?a:String(a)),i)}var r,a}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var n=l(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:o):i.value}}).apply(this,arguments)}function l(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=u(t);if(e){var i=u(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return d(this,o)}}function d(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(d,M.impl.Control);var e,o,n,l=c(d);function d(){return i(this,d),l.apply(this,arguments)}return e=d,(o=[{key:"addTo",value:function(t,e){this.facadeMap_=t,a(u(d.prototype),"addTo",this).call(this,t,e)}},{key:"getCoordinates",value:function(t,e,o,n,i){var r=t.getId(),a=t.getAttribute("coordinates"),l=t.getAttribute("EPSGcode"),s=ol.proj.transform(a,l,"EPSG:4326"),c=this.datumCalc(e),d={NumPoint:r,projectionGEO:{code:"--",coordinatesGEO:{longitude:"--",latitude:"--"}},projectionUTM:{code:"--",datum:"--",coordinatesUTM:{coordX:"--",coordY:"--"}}};if(null!=e){var u=ol.proj.transform(a,l,e);if(d={NumPoint:r,projectionGEO:{code:e,coordinatesGEO:{longitude:s[0].toFixed(n),latitude:s[1].toFixed(n)}},projectionUTM:{code:e,datum:c,coordinatesUTM:{coordX:u[0].toFixed(i),coordY:u[1].toFixed(i)}}},1==o){var p=ol.coordinate.toStringHDMS(s,2);d.projectionGEO.coordinatesGEO.latitude=p.substr(0,17),d.projectionGEO.coordinatesGEO.longitude=p.substr(17)}}return d}},{key:"datumCalc",value:function(t){var e="ETRS89";return t.indexOf("3857")>-1?e="WGS84":t.indexOf("4083")>-1&&(e="REGCAN95"),e}},{key:"readAltitudeFromWCSservice",value:function(t,e){var o=ol.proj.transform(t,e,"EPSG:4258"),n=[[o[0],o[1]],[o[0]+1e-6,o[1]+1e-6]],i="".concat("https://servicios.idee.es/wcs-inspire/mdt?request=GetCoverage&bbox=").concat(n).concat("&service=WCS&version=1.0.0&coverage=Elevacion4258_5&interpolationMethod=bilinear&crs=EPSG%3A4258&format=ArcGrid&width=2&height=2");return M.remote.get(i)}},{key:"transform",value:function(t,e,o){return ol.proj.transform(t,e,o)}},{key:"transformExt",value:function(t,e,o){return ol.proj.transformExtent(t,e,o)}},{key:"activateClick",value:function(t){this.dblClickInteraction_.setActive(!1),t.getMapImpl().on("dblclick",(function(e){var o=new CustomEvent("mapclicked",{detail:e.coordinate,bubbles:!0});t.getContainer().dispatchEvent(o)}))}},{key:"deactivateClick",value:function(t){this.dblClickInteraction_.setActive(!0),t.getMapImpl().removeEventListener("dblclick")}}])&&r(e.prototype,o),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),d}(),m=o(2),y=o.n(m),f=o(0),v=o(1),b={en:f,es:v},h=function(){var t="es";return"function"==typeof M.language.getLang&&(t=M.language.getLang()),t},g=function(t){return"es"===t||"en"===t?b[t]:M.language.getTranslation(t).infocoordinates},E=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h(),o=g(e),n="";return M.utils.isNullOrEmpty(o)?console.warn("The translation '".concat(e,"' has not been defined.")):n=t.split(".").reduce((function(t,e){return t[e]}),o),n};function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,r=void 0,r=function(t,e){if("object"!==P(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===P(r)?r:String(r)),n)}var i,r}function O(t,e){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=C(t);if(e){var i=C(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return w(this,o)}}function w(t,e){if(e&&("object"===P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}(r,M.Control);var e,o,n,i=S(r);function r(t,e,o,n,a){var l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),M.utils.isUndefined(p)&&M.exception(E("expection.impl"));var s=new p;return(l=i.call(this,s,"Infocoordinates")).map_=null,l.numTabs=0,l.layerFeatures=new M.layer.Vector,l.layerFeatures.name="infocoordinatesLayerFeatures",l.layerFeatures.displayInLayerSwitcher=!1,l.decimalGEOcoord=t,l.decimalUTMcoord=e,l.helpUrl=o,l.clickedDeactivate=!1,l.order=n,l.outputDownloadFormat=a,l}return e=r,(o=[{key:"createView",value:function(t){var e=this;return this.map_=t,M.template.compileSync||(M.template.compileSync=function(t,e){var o,n={};M.utils.isUndefined(e)||(n=M.utils.extends(n,e.vars),o=e.parseToHtml);var i=Handlebars.compile(t)(n);return!1!==o?M.utils.stringToHtml(i):i}),new Promise((function(t,o){var n={jsonp:!0,vars:{hasHelp:void 0!==e.helpUrl&&M.utils.isUrl(e.helpUrl),helpUrl:e.helpUrl,translations:{title:E("title"),point:E("point"),datum:E("datum"),latitude:E("latitude"),longitude:E("longitude"),formatCoordinates:E("formatCoordinates"),coordX:E("coordX"),coordY:E("coordY"),altitude:E("altitude"),removePoint:E("removePoint"),removeAllPoints:E("removeAllPoints"),importAllPoints:E("importAllPoints"),copyLatLon:E("copyLatLon"),copyxy:E("copyxy"),copyAllPoints:E("copyAllPoints"),displayONAllPoints:E("displayONAllPoints"),displayOFFAllPoints:E("displayOFFAllPoints")}}},i=M.template.compileSync(y.a,n);e.accessibilityTab(i),e.map_.addLayers(e.layerFeatures),e.panel_.on(M.evt.SHOW,e.activate,e),e.panel_.on(M.evt.HIDE,e.deactivate,e),t(i),i.querySelector("#m-infocoordinates-buttonRemoveAllPoints").addEventListener("click",e.removeAllPoints.bind(e)),i.querySelector("#m-infocoordinates-buttonImportAllPoints").addEventListener("click",e.importAllPoints.bind(e)),i.querySelector("#m-infocoordinates-buttonCopyAllPoints").addEventListener("click",e.copyAllPoints.bind(e)),i.querySelector("#m-infocoordinates-buttonDisplayAllPoints").addEventListener("click",e.displayAllPoints.bind(e)),i.querySelector("#m-infocoordinates-comboDatum").addEventListener("change",e.changeSelectSRSorChangeFormat.bind(e)),i.querySelector("#m-infocoordinates-buttonConversorFormat").addEventListener("change",e.changeSelectSRSorChangeFormat.bind(e)),i.querySelector("#m-infocoordinates-buttonRemovePoint").addEventListener("click",e.removePoint.bind(e)),i.querySelector("#m-infocoordinates-copylatlon").addEventListener("click",e.copylatlon.bind(e)),i.querySelector("#m-infocoordinates-copyxy").addEventListener("click",e.copyxy.bind(e))}))}},{key:"activate",value:function(){this.invokeEscKey(),this.map_.on(M.evt.CLICK,this.addPoint,this),document.body.style.cursor="crosshair",this.map_.getFeatureHandler().deactivate(),document.addEventListener("keyup",this.checkEscKey.bind(this)),this.clickedDeactivate&&document.querySelector("div.m-panel.m-plugin-infocoordinates > button").click()}},{key:"checkEscKey",value:function(t){var e=document.querySelector("div.m-panel.m-plugin-infocoordinates").classList.contains("opened");"Escape"===t.key&&e&&(document.querySelector("div.m-panel.m-plugin-infocoordinates.opened > button").click(),document.removeEventListener("keyup",this.checkEscKey))}},{key:"invokeEscKey",value:function(){try{document.dispatchEvent(new window.KeyboardEvent("keyup",{key:"Escape",keyCode:27,code:"",which:69,shiftKey:!1,ctrlKey:!1,metaKey:!1}))}catch(t){console.error(t)}}},{key:"deactivate",value:function(){this.clickedDeactivate=!0,this.map_.un(M.evt.CLICK,this.addPoint,this),document.body.style.cursor="default",this.map_.getFeatureHandler().activate()}},{key:"addPoint",value:function(t){var e=this,o=this.numTabs+1;document.getElementById("m-infocoordinates-comboDatum").removeAttribute("disabled"),document.getElementById("m-infocoordinates-buttonConversorFormat").removeAttribute("disabled"),document.getElementById("m-infocoordinates-buttonRemovePoint").classList.remove("noDisplay"),document.getElementById("m-infocoordinates-copylatlon").classList.remove("noDisplay"),document.getElementById("m-infocoordinates-copyxy").classList.remove("noDisplay"),document.getElementsByClassName("m-infocoordinates-div-buttonRemoveAllPoints")[0].classList.remove("noDisplay"),document.getElementsByClassName("m-infocoordinates-div-buttonImportAllPoints")[0].classList.remove("noDisplay"),document.getElementsByClassName("m-infocoordinates-div-buttonCopyAllPoints")[0].classList.remove("noDisplay"),document.getElementsByClassName("m-infocoordinates-div-buttonDisplayAllPoints")[0].classList.remove("noDisplay"),0===document.getElementsByClassName("icon-displayON").length&&this.map_.getMapImpl().getOverlays().array_.length>0&&this.removeAllDisplaysPoints();var n=document.getElementsByClassName("m-infocoordinates-tabs")[0],i=document.createElement("button"),r=document.createTextNode(o);i.appendChild(r),i.classList.add("tablinks"),i.setAttribute("id","tablink".concat(o)),i.setAttribute("tabindex","0"),i.setAttribute("type","button"),n.appendChild(i);var a,l=t.coord,s=new M.Feature(o,{type:"Feature",id:o,geometry:{type:"Point",coordinates:[l[0],l[1]]},properties:{EPSGcode:this.map_.getProjection().code,coordinates:[l[0],l[1]]}});n.scrollTop=n.scrollHeight;var c=document.getElementById("m-infocoordinates-altitude");M.proxy(!1),new Promise((function(t,o){c.innerHTML=E("readingAltitude"),t(a=e.getImpl().readAltitudeFromWCSservice(l,e.map_.getProjection().code))})).then((function(t){var n=t.text.split("NODATA_value -9999.000").join("");null==(a=n.split(/\n/)[5].split(" ")[1])&&(a=E("noDatafromWCS")),s.setAttribute("Altitude",a),c.innerHTML="".concat(parseFloat(a).toFixed(2)).replace(".",","),i.addEventListener("click",(function(){return e.openTabFromTab(o)}))})),M.proxy(!0),this.layerFeatures.addFeatures([s]),this.layerFeatures.setZIndex(999),this.openTab(o),this.numTabs=o}},{key:"activateSelection",value:function(){var t=this,e=this.facadeMap_.getMapImpl(),o=this.facadeControl,n=o.drawLayer.getImpl().getOL3Layer();this.facadeControl.hideTextPoint(),null!==document.querySelector(".m-geometrydraw>#downloadFormat")&&document.querySelector(".m-geometrydraw").removeChild(o.downloadingTemplate),n&&(this.select=new ol.interaction.Select({wrapX:!1,layers:[n]}),this.select.on("select",(function(e){e.target.getFeatures().getArray().length>0&&t.facadeControl.onSelect(e)})),e.addInteraction(this.select),this.edit=new ol.interaction.Modify({features:this.select.getFeatures()}),this.edit.on("modifyend",(function(e){t.facadeControl.onModify()})),e.addInteraction(this.edit))}},{key:"selectFeature",value:function(t){var e=this;this.point=new M.style.Point({icon:{form:M.style.form.NONE,class:"+",fontsize:1.5,radius:10,color:"black",fill:"white"}}),this.pointDisable=new M.style.Point({radius:5,icon:{form:"none",class:"+",radius:15,rotation:0,rotate:!1,offset:[0,0],color:"#2690e7",opacity:1,stroke:{width:20}}});var o=document.getElementsByClassName("contenedorPunto").length+document.getElementsByClassName("contenedorPuntoSelect").length;if(t>o)this.displayPoint(t);else if(t===o)document.querySelectorAll(".contenedorPunto").forEach((function(e){parseInt(e.textContent,10)===t&&e.classList.replace("contenedorPunto","contenedorPuntoSelect")})),0===document.getElementsByClassName("icon-displayON").length&&this.map_.getMapImpl().getOverlays().array_.length>0&&this.removeAllDisplaysPoints();else{document.getElementsByClassName("contenedorPuntoSelect")[0].classList.replace("contenedorPuntoSelect","contenedorPunto");try{document.getElementsByClassName("contenedorPunto")[document.getElementsByClassName("contenedorPunto").length-t].classList.replace("contenedorPunto","contenedorPuntoSelect")}catch(t){}0===document.getElementsByClassName("icon-displayON").length&&this.map_.getMapImpl().getOverlays().array_.length>0&&this.removeAllDisplaysPoints()}this.layerFeatures.getFeatures().map((function(t){return t.setStyle(e.pointDisable)})),this.layerFeatures.getFeatureById(t).setStyle(this.point)}},{key:"displayPoint",value:function(t){var e=this.layerFeatures.impl_.features_[t-1].impl_.olFeature_.values_.coordinates;t>1&&document.getElementsByClassName("contenedorPuntoSelect")[0].classList.replace("contenedorPuntoSelect","contenedorPunto");var o='<div class="contenedorPuntoSelect">\n                <table>\n                    <tbody>\n                      <tr>\n                        <td style="font-weight: bold; font-family: arial;">'.concat(t,"</td></b>\n                      </tr>\n                    </tbody>\n                </table>\n            </div>\n          </div>\n      </div>"),n=M.template.compileSync(o,{jsonp:!0,vars:{translations:E("text")}});this.helpTooltip_=new ol.Overlay({element:n,offset:[10,-5]}),this.helpTooltip_.setPosition(e),this.map_.getMapImpl().addOverlay(this.helpTooltip_)}},{key:"activateTab",value:function(t){for(var e=document.getElementsByClassName("tablinks"),o=0;o<e.length;o++)e[o].classList.remove("active");document.getElementById("tablink".concat(t)).classList.add("active")}},{key:"changeSelectSRSorChangeFormat",value:function(){var t=document.querySelector(".tablinks.active");if(null!==t){var e=parseInt(t.textContent);this.displayXYcoordinates(e)}}},{key:"displayXYcoordinates",value:function(t){var e=this.layerFeatures.getFeatureById(t),o=document.getElementById("m-infocoordinates-point"),n=document.getElementById("m-infocoordinates-latitude"),i=document.getElementById("m-infocoordinates-longitude"),r=document.getElementById("m-infocoordinates-datum"),a=document.getElementById("m-infocoordinates-coordX"),l=document.getElementById("m-infocoordinates-coordY"),s=document.getElementById("m-infocoordinates-comboDatum").value,c=document.getElementById("m-infocoordinates-buttonConversorFormat").checked,d=this.getImpl().getCoordinates(e,s,c,this.decimalGEOcoord,this.decimalUTMcoord);o.innerHTML=d.NumPoint,n.innerHTML="".concat(d.projectionGEO.coordinatesGEO.latitude).replace(".",","),i.innerHTML="".concat(d.projectionGEO.coordinatesGEO.longitude).replace(".",","),r.innerHTML=d.projectionUTM.datum,a.innerHTML=this.formatUTMCoordinate(d.projectionUTM.coordinatesUTM.coordX),l.innerHTML=this.formatUTMCoordinate(d.projectionUTM.coordinatesUTM.coordY)}},{key:"displayZcoordinate",value:function(t){var e=this.layerFeatures.getFeatureById(t);document.getElementById("m-infocoordinates-altitude").innerHTML="".concat(parseFloat(e.getAttribute("Altitude")).toFixed(2)).replace(".",",")}},{key:"openTab",value:function(t){this.selectFeature(t),this.activateTab(t),this.displayXYcoordinates(t)}},{key:"openTabFromTab",value:function(t){this.selectFeature(t),this.activateTab(t),this.displayXYcoordinates(t),this.displayZcoordinate(t)}},{key:"removePoint",value:function(){if(document.getElementsByClassName("tablinks").length>1){var t=document.getElementsByClassName("m-infocoordinates-tabs")[0].children.length,e=document.querySelector(".tablinks.active"),o=e.textContent;e.parentNode.removeChild(e);var n=this.layerFeatures.getFeatureById(parseInt(o));this.layerFeatures.removeFeatures(n),this.layerFeatures.getFeatures().forEach((function(t){t.getId()>o&&t.setId(t.getId()-1)}));for(var i=o-1;i<t-1;i+=1){var r=document.getElementById("tablink".concat(i+2)),a=parseInt(r.innerHTML,10);r.setAttribute("id","tablink".concat(a-1)),r.innerHTML=a-1}document.querySelector(".contenedorPuntoSelect").parentNode.remove(),document.querySelectorAll(".contenedorPunto").forEach((function(t){if(parseInt(t.textContent.trim(),10)>o){var e=parseInt(t.querySelector("td").innerHTML,10);t.querySelector("td").innerHTML=e-1}}));var l=document.getElementsByClassName("m-infocoordinates-tabs")[0].lastChild;l.classList.add("active"),this.numTabs=this.numTabs-1,this.openTabFromTab(parseInt(l.textContent))}else this.removeAllPoints()}},{key:"copylatlon",value:function(){var t=document.getElementById("m-infocoordinates-latitude").innerHTML.replace(",","."),e=document.getElementById("m-infocoordinates-longitude").innerHTML.replace(",","."),o=document.getElementById("m-infocoordinates-altitude").innerHTML.replace(",","."),n=document.getElementById("m-infocoordinates-comboDatum").value;n=n.indexOf("25829")>-1||n.indexOf("25830")>-1||n.indexOf("25831")>-1?"EPSG:4258":"EPSG:4326";var i="".concat(e,",").concat(t,",").concat(o,",").concat(n);navigator.clipboard.writeText(i),M.toast.success(E("clipboard"))}},{key:"copyxy",value:function(){var t=document.getElementById("m-infocoordinates-coordX").innerHTML.replaceAll(".","").replace(",","."),e=document.getElementById("m-infocoordinates-coordY").innerHTML.replaceAll(".","").replace(",","."),o=document.getElementById("m-infocoordinates-altitude").innerHTML.replaceAll(".","").replace(",","."),n=document.getElementById("m-infocoordinates-comboDatum").value,i="".concat(t,",").concat(e,",").concat(o,",").concat(n);navigator.clipboard.writeText(i),M.toast.success(E("clipboard"))}},{key:"copyAllPoints",value:function(){for(var t=E("point").replace(":","")+",Long,Lat,Alt,EPSG,X,Y,Alt,EPSG\n",e=0;e<this.layerFeatures.impl_.features_.length;e+=1){var o=this.layerFeatures.impl_.features_[e],n=void 0!==o.getAttributes().Altitude?parseFloat(o.getAttributes().Altitude):"-",i=document.getElementById("m-infocoordinates-comboDatum").value,r=document.getElementById("m-infocoordinates-buttonConversorFormat").checked,a=this.getImpl().getCoordinates(o,i,r,this.decimalGEOcoord,this.decimalUTMcoord),l=a.projectionUTM.code,s=[a.projectionGEO.coordinatesGEO.longitude,a.projectionGEO.coordinatesGEO.latitude],c=[a.projectionUTM.coordinatesUTM.coordX,a.projectionUTM.coordinatesUTM.coordY],d=void 0;d=l.indexOf("25829")>-1||l.indexOf("25830")>-1||l.indexOf("25831")>-1?",EPSG:4258":",EPSG:4326";var u=e+1+","+s+","+n.toString()+d.trim()+","+c+","+n.toString()+","+l+"\n";t=t.concat(u)}navigator.clipboard.writeText(t),M.toast.success(E("clipboard"))}},{key:"importAllPoints",value:function(){var t=[];"csv"===this.outputDownloadFormat&&t.push(E("point").replace(":","")+",Long,Lat,Alt,EPSG,X,Y,Alt,EPSG\n");for(var e=0;e<this.layerFeatures.impl_.features_.length;e+=1){var o=this.layerFeatures.impl_.features_[e],n=void 0!==o.getAttributes().Altitude?parseFloat(o.getAttributes().Altitude):"-",i=document.getElementById("m-infocoordinates-comboDatum").value,r=document.getElementById("m-infocoordinates-buttonConversorFormat").checked,a=this.getImpl().getCoordinates(o,i,r,this.decimalGEOcoord,this.decimalUTMcoord),l=a.projectionUTM.code,s=[a.projectionGEO.coordinatesGEO.longitude,a.projectionGEO.coordinatesGEO.latitude],c=[a.projectionUTM.coordinatesUTM.coordX,a.projectionUTM.coordinatesUTM.coordY],d="EPSG:4326: ";(l.indexOf("25829")>-1||l.indexOf("25830")>-1||l.indexOf("25831")>-1)&&(d="EPSG:4258: "),"csv"===this.outputDownloadFormat?t.push(e+1+","+s+","+n.toString()+","+d.trim().slice(0,-1)+","+c+","+n.toString()+","+l+"\n"):(t.push(E("point").replace(":"," ")+(e+1)+": \n"),t.push(d),t.push("["+s+","+n+"]\n"),t.push(l+": "),t.push("["+c+","+n+"]\n"))}var u=new Blob(t,{type:"csv"===this.outputDownloadFormat?"csv":"text/plain"}),p=new Date,m="mapa_".concat(p.getFullYear(),"-",p.getMonth()+1,"-",p.getDay()+1,"_",p.getHours(),p.getMinutes(),p.getSeconds());this.descargarArchivo(u,m.concat(".".concat(this.outputDownloadFormat)))}},{key:"displayAllPoints",value:function(){if(0===document.getElementsByClassName("icon-displayON").length&&this.map_.getMapImpl().getOverlays().array_.length>0)this.removeAllDisplaysPoints();else{document.getElementsByClassName("icon-displayON")[0].classList.replace("icon-displayON","icon-displayOFF"),document.getElementsByClassName("icon-displayOFF")[0].title=E("displayOFFAllPoints");for(var t=0;t<document.getElementsByClassName("contenedorPunto").length;t+=1)document.getElementsByClassName("contenedorPunto")[t].style="display: none";document.getElementsByClassName("contenedorPuntoSelect")[0].style="display: none";for(var e=0;e<this.layerFeatures.impl_.features_.length;e+=1){var o=this.layerFeatures.impl_.features_[e].impl_.olFeature_.values_.coordinates,n=this.calculateUTMcoordinates(e+1),i="".concat(parseFloat(this.layerFeatures.impl_.features_[e].impl_.olFeature_.values_.Altitude).toFixed(2)).replace(".",","),r='<div class="m-popup m-collapsed" style="padding: 5px 5px 5px 5px !important;background-color: rgba(255, 255, 255, 0.7) !important;">\n              <div class="contenedorCoordPunto">\n                <table>\n                    <tbody>\n                      <tr>\n                        <td style="font-weight: bold">'.concat(E("point")," ").concat(e+1,"</td></b>\n                      </tr>\n                      <tr>\n                        <td>X: ").concat(this.formatUTMCoordinate(n[0]),"</td>\n                      </tr>\n                      <tr>\n                        <td>Y: ").concat(this.formatUTMCoordinate(n[1]),"</td>\n                      </tr>\n                      <tr>\n                        <td>").concat(E("altitude")," ").concat(i,"</td>\n                      </tr>\n                    </tbody>\n                </table>\n            </div>\n          </div>\n          </div>\n      </div>"),a=M.template.compileSync(r,{jsonp:!0,vars:{translations:E("text")}});this.helpTooltip_=new ol.Overlay({element:a,offset:[10,-5]}),this.helpTooltip_.setPosition(o),this.map_.getMapImpl().addOverlay(this.helpTooltip_)}}}},{key:"calculateUTMcoordinates",value:function(t){var e=this.layerFeatures.getFeatureById(t),o=document.getElementById("m-infocoordinates-comboDatum").value,n=document.getElementById("m-infocoordinates-buttonConversorFormat").checked,i=this.getImpl().getCoordinates(e,o,n,this.decimalGEOcoord,this.decimalUTMcoord);return[i.projectionUTM.coordinatesUTM.coordX,i.projectionUTM.coordinatesUTM.coordY]}},{key:"removeAllDisplaysPoints",value:function(){document.getElementsByClassName("icon-displayOFF")[0].classList.replace("icon-displayOFF","icon-displayON"),document.getElementsByClassName("icon-displayON")[0].title=E("displayONAllPoints");for(var t=0;t<document.getElementsByClassName("contenedorPunto").length;t+=1)document.getElementsByClassName("contenedorPunto")[t].style="display: block";document.getElementsByClassName("contenedorPuntoSelect")[0].style="display: block";for(var e=this.map_.getMapImpl().getOverlays().getArray().length-1;e>-1;e-=1)"m-popup m-collapsed"===this.map_.getMapImpl().getOverlays().array_[e].options.element.className&&this.map_.getMapImpl().removeOverlay(this.map_.getMapImpl().getOverlays().getArray()[e])}},{key:"descargarArchivo",value:function(t,e){var o=new FileReader;o.onload=function(t){var o=document.createElement("a");o.href=t.target.result,o.target="_blank",o.download=e||"archivo.dat";var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});o.dispatchEvent(n),(window.URL||window.webkitURL).revokeObjectURL(o.href)},o.readAsDataURL(t)}},{key:"removeAllPoints",value:function(){document.getElementsByClassName("m-infocoordinates-tabs")[0].innerHTML="",document.getElementById("m-infocoordinates-point").innerHTML="--",document.getElementById("m-infocoordinates-latitude").innerHTML="--",document.getElementById("m-infocoordinates-longitude").innerHTML="--",document.getElementById("m-infocoordinates-coordX").innerHTML="--",document.getElementById("m-infocoordinates-coordY").innerHTML="--",document.getElementById("m-infocoordinates-altitude").innerHTML="--",document.getElementById("m-infocoordinates-buttonRemovePoint").classList.add("noDisplay"),document.getElementById("m-infocoordinates-copylatlon").classList.add("noDisplay"),document.getElementById("m-infocoordinates-copyxy").classList.add("noDisplay"),document.getElementsByClassName("m-infocoordinates-div-buttonRemoveAllPoints")[0].classList.add("noDisplay"),document.getElementsByClassName("m-infocoordinates-div-buttonImportAllPoints")[0].classList.add("noDisplay"),document.getElementsByClassName("m-infocoordinates-div-buttonCopyAllPoints")[0].classList.add("noDisplay"),document.getElementsByClassName("m-infocoordinates-div-buttonDisplayAllPoints")[0].classList.add("noDisplay"),document.getElementById("m-infocoordinates-buttonConversorFormat").setAttribute("disabled","disabled"),this.layerFeatures.removeFeatures(this.layerFeatures.getFeatures());for(var t=this.map_.getMapImpl().getOverlays().getArray().length-1;t>-1;t-=1)this.map_.getMapImpl().removeOverlay(this.map_.getMapImpl().getOverlays().getArray()[t]);this.numTabs=0}},{key:"equals",value:function(t){return t instanceof r}},{key:"removeLayerFeatures",value:function(){this.map_.removeLayers(this.layerFeatures)}},{key:"formatUTMCoordinate",value:function(t){return t.replace(/\d(?=(\d{3})+\.)/g,"$&*").split(".").join(",").split("*").join(".")}},{key:"accessibilityTab",value:function(t){var e=this;t.querySelectorAll('[tabindex="0"]').forEach((function(t){return t.setAttribute("tabindex",e.order)}))}}])&&_(e.prototype,o),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),r}(),A=o(3);function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,r=void 0,r=function(t,e){if("object"!==F(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===F(r)?r:String(r)),n)}var i,r}function k(t,e){return(k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=j(t);if(e){var i=j(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return B(this,o)}}function B(t,e){if(e&&("object"===F(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k(t,e)}(r,M.Plugin);var e,o,n,i=L(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};I(this,r),(t=i.call(this)).map_=null,t.decimalGEOcoord_=e.decimalGEOcoord||4,t.decimalUTMcoord_=e.decimalUTMcoord||2,t.name_="infocoordinates",t.controls_=[],t.control_=null;var o=["TR","TL","BL","BR"];return t.position_=o.includes(e.position)?e.position:"TR",t.collapsed_=e.collapsed,void 0===t.collapsed_&&(t.collapsed_=!0),t.collapsible_=e.collapsible,void 0===t.collapsible_&&(t.collapsible_=!0),t.metadata_=A.metadata,t.helpUrl_=e.helpUrl||"https://www.ign.es/",t.outputDownloadFormat_=e.outputDownloadFormat||"txt",t.order=e.order>=-1?e.order:null,t.tooltip_=e.tooltip||E("tooltip"),t.options=e,t}return e=r,n=[{key:"getJSONTranslations",value:function(t){return"en"===t||"es"===t?"en"===t?f:v:M.language.getTranslation(t).infocoordinates}}],(o=[{key:"addTo",value:function(t){this.control_=new T(this.decimalGEOcoord_,this.decimalUTMcoord_,this.helpUrl_,this.order,this.outputDownloadFormat_),this.controls_.push(this.control_),this.map_=t,this.panel_=new M.ui.Panel("Infocoordinates",{collapsed:this.collapsed_,collapsible:this.collapsible_,position:M.ui.position[this.position_],className:"m-plugin-infocoordinates",collapsedButtonClass:"icon-target",tooltip:this.tooltip_,order:this.order}),this.panel_.addControls(this.controls_),t.addPanels(this.panel_)}},{key:"destroy",value:function(){this.map_.removeControls([this.control_]),this.control_.deactivate(),this.control_.removeLayerFeatures();var t=[null,null,null];this.control_=t[0],this.panel_=t[1],this.map=t[2]}},{key:"name",get:function(){return this.name_}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position_,"*").concat(this.collapsed_,"*").concat(this.collapsible_,"*").concat(this.tooltip_,"*").concat(this.decimalGEOcoord_,"*").concat(this.decimalUTMcoord_,"*").concat(this.helpUrl_,"*").concat(this.outputDownloadFormat_)}},{key:"getAPIRestBase64",value:function(){return"".concat(this.name,"=base64=").concat(M.utils.encodeBase64(this.options))}}])&&x(e.prototype,o),n&&x(e,n),Object.defineProperty(e,"prototype",{writable:!1}),r}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.Infocoordinates=D,window.M.control.InfocoordinatesControl=T,window.M.impl.control.InfocoordinatesControl=p}]);
//# sourceMappingURL=infocoordinates-1.1.0.ol.min.js.map